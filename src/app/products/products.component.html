<div class="icons_menu">
  <button mat-icon-button [matMenuTriggerFor]="menu">
    <mat-icon>sort</mat-icon>
  </button>
  <button routerLink="/shopping-cart" mat-icon-button *ngIf="cart$ | async as cart">
    <mat-icon [matBadge]="cart.totalItemsCount" matBadgeColor="warn">add_shopping_cart</mat-icon>
  </button>
</div>

<mat-menu #menu="matMenu">
  <a
    *ngFor="let c of categories$ | async"
    mat-menu-item
    [routerLink]="['/products/']"
    [queryParams]="{ category: c.id }"
  >
    {{c.name}}
  </a>
</mat-menu>
<div class="flex">
  <div *ngFor="let p of filteredProducts">
    <h2>{{p.title}}</h2>
    <a [routerLink]="['/product-item/', p.id]">
      <img [src]=p.image />
    </a>
    <p>EUR {{p.price}}</p>
    <button
      (click)="addToCart(p)"
      *ngIf="getQuantity(p) === 0; else updateQuantity"
      mat-raised-button
      color="warn"
    >
      Add to cart
    </button>
    <ng-template #updateQuantity>
        <button
          mat-button
          (click)="removeFromCart(p)"
        >
          <mat-icon>navigate_before</mat-icon>
        </button>
        {{getQuantity(p)}}
        <button
          mat-button
          (click)="addToCart(p)"
        >
          <mat-icon>navigate_next</mat-icon>
        </button>
    </ng-template>
  </div>
</div>
